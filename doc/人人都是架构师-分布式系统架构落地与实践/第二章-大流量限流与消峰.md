## 大流量限流与消峰
### 应对大流量手段
* 动静分离，静态不变cdn，动态放后端
* 服务拆分提高系统的鲁棒性
* 扩容
* 缓存
* 分库分表读写分离
* 异步
* 降级
* 限流
* 熔断
### 常见限流算法
* 令牌桶  
    限输入流量，每秒放入的个数限定死。允许一定的突发流量，比如突然整个桶满，桶里的请求都可被服务，但由于输入流量被限制，之后有一段时间内桶内不允许加入请求。超过部分丢弃  
    例如：guava rateLimit
* 漏桶  
    限输出流量（即被服务的流量），超过部分丢弃。输入不限制，随意加，超过部分被放弃。固定速率从桶中拿请求来处理
* 计数器限流  
    比如针对热点商品抢购限流，防止热点单行数据压力过大
* 答题限流  
    如12306
### 消峰方式
* 基于消息  
    activemq 遵循jms,适用于非大规模流量
    rocketmq,kafka，不遵循jms，适用于大规模流量
    rocketmq特性：  
    **  事务消息  
    **  顺序消息  
    **  亿级消息堆积  
    **  分布式特性  
    **  集群与广播  
    **  推拉模式  
    rocketmq部署方式：  
    **  单master  
    **  多master(各自存的数据不一样)  
    **  master-slave同步双写（吞吐量低，数据完全一致）  
    **  master-slave异步复制（切换时存在毫秒级的延迟） 
    rocketmq包含组件： 
    **  consumer,producer  
    **  broker  
    **  nameserver(注册中心)  
### 分布式配置
*  zk
*  diamond
*  disconf
### 数据库
*  alisql:针对互联网大并发做优化  
   比如秒杀，收集秒杀请求，然后批量提交。将mysql串行改成并行，同时在提交时，新的收集已开始  
*  数据库分库分表  
   